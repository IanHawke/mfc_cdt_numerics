<!DOCTYPE html>
<html lang="en"><head>
<script src="lecture_fe_dg_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture_fe_dg_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture_fe_dg_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture_fe_dg_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture_fe_dg_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture_fe_dg_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lecture_fe_dg_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lecture_fe_dg_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.551">

  <title>Lecture 8</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture_fe_dg_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture_fe_dg_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lecture_fe_dg_files/libs/revealjs/dist/theme/quarto.css">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="lecture_fe_dg_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 8</h1>
  <p class="subtitle">Discontinuous Galerkin Methods</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="unstructured-grids" class="slide level2">
<h2>Unstructured grids</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Most problems have complex domains.</li>
<li>Use unstructured grids.</li>
<li>Use <em>Finite Elements</em>.</li>
<li>How to recapture spectral (like) convergence?</li>
</ul>
</div><div class="column" style="width:40%;">
<div id="1375ce5e" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lecture_fe_dg_files/figure-revealjs/cell-2-output-1.svg" alt="An unstructured grid representing parts of the UK"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="communication" class="slide level2">
<h2>Communication</h2>

<img data-src="lecture_fe_dg_files/figure-revealjs/cell-3-output-1.svg" alt="A sketch of a communication pattern on CPUs" class="r-stretch"><ul>
<li>Parallel computing splits tasks across cores.</li>
<li>Communicate information as needed - <em>ghost points</em>.</li>
<li>Exascale - millions of GPUs: communication limit.</li>
<li>Bigger “numerical stencils” hit limit earlier.</li>
<li>Simple spectral method couples <em>every</em> point.</li>
</ul>
<aside class="notes">
<p>When the problem gets too big to solve on one compute core we have to split it across multiple cores. This reduces memory usage (on an individual core) and speeds the calculation as individual tasks are done in parallel and the results later recombined. The sketch figure shows this: the global grid in black is split across three cores. Each core gets about one third of the points. However, each point on the grid needs a neighbour to do the calculation. Therefore there has to be an overlap in the grid points that each core has access to. After the calculation is done on the interior points (shown with solid colour), the overlap (or <em>ghost</em> points) need to be updated. This is done by communicating the data from the other core on which the values have been computed.</p>
<p>The number of parallel cores has been steadily growing, and with the next generation of machines they will be able to do millions of tasks in parallel. That means the amount of data being communicated will be crucial in determining the performance. In general, communication is much slower than calculation - four to six orders of magnitude slower is not unusual.</p>
<p>Finite difference and finite volume methods have an easily understood <em>stencil</em> - the number of neighbours needed to update a single point. The sketch shows the case where two ghost points are needed, which is not unusual for a simple such method. However, methods that rely on solving linear systems, such as simple spectral and finite element methods, effectively couple <em>every</em> point in the domain. The communication costs will stop any gains from parallel computing.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="basis-functions" class="slide level2">
<h2>Basis functions</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>Standard FE function basis continuous at nodes - couples neighbouring elements.</li>
<li><em>Discontinuous Galerkin</em> basis functions only inside elements:
<ul>
<li>only couples to direct neighbour;</li>
<li>solution multi-valued at element boundary.</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<div id="74c912a1" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lecture_fe_dg_files/figure-revealjs/cell-4-output-1.svg" alt="Admissible solutions using linear basis functions for Galerkin finite elements (top) and Discontinuous Galerkin (bottom)"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>The reason why the finite element methods that we have looked at so far have bad communication patterns is that the basis functions used are indicator functions. This means we always have overlaps with other basis functions in two neighbouring elements (at least - in higher dimensions it gets worse). This means that the final global stiffness matrix implicitly couples every point in the domain. Now, fast parallel linear solvers do exist, and the matrix is sparse, so this is not disastrous (unlike the spectral method, where the matrix formed is <em>not</em> sparse, killing performance). However, we can do better.</p>
<p>In the Discontinuous Galerkin method the basis functions only have support inside a single element. We would now typically expect to use multiple basis functions inside a single element to get higher accuracy. This means that basis functions in neighbouring elements only couple through a single value at the boundary, rather than via a complete overlap integral. This minimizes inter-element coupling, massively reducing communication costs.</p>
<p>The downside of this approach is that the resulting solution is not continuous at element boundaries, hence the name of the method. We have to be able to update the basis function coefficients inside the element taking into account the <em>intra</em> element overlaps, and also the jumps at the element boundaries.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="basis-functions-and-weak-form" class="slide level2">
<h2>Basis functions and weak form</h2>
<p>For eg advection <span class="math inline">\(\partial_t \psi + u \partial_x \psi = 0\)</span>, basis</p>
<p><span class="math display">\[
\psi = \sum_a \hat{\psi}_a(t) N_a(x)
\]</span></p>
<p>gives mass-stiffness discrete form</p>
<p><span class="math display">\[
\hat{M}_{ab} \partial_t \hat{\psi}_a + \hat{K}_{ab} \hat{\psi}_a = \hat{F}_b
\]</span></p>
<p><em>within one single element</em>. <span class="math inline">\(\hat{\mathbf{F}}\)</span> is inter-element boundary flux.</p>
<aside class="notes">
<p>From the weak form applied to the single element we introduce the basis expansion within that single element alone. Note that we are now indexing using an ordered integer <code>n</code> that counts individual modes, rather than the label <code>A</code> which (at least in principle) has no order at all.</p>
<p>At this stage the mathematical steps are identical to the Galerkin finite element approaches; the weak form, expanded using the basis, gives a mass matrix multiplying the time derivatives, where the mass matrix is the integral over the element of two basis functions. The weak form also gives the stiffness matrix which, for the first derivative advective term, is the integral over the element of one basis function and one differentiated basis function. The force vector links one element to the next through the “flux” of the given mode number between elements.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="legendre-polynomials" class="slide level2">
<h2>Legendre polynomials</h2>
<p>Mass matrix <span class="math inline">\(\hat{M}_{ab} = \int N_a N_b\)</span>. Choose <span class="math inline">\(N_a\)</span> orthonormal <span class="math inline">\(\implies \hat{M}\)</span> identity.</p>
<p>In 1d, map <span class="math inline">\(x \to \xi \in [-1, 1]\)</span>: use <em>Legendre polynomials</em> <span class="math inline">\(P_a(\xi)\)</span>.</p>
<p>Need boundary flux. Have <span class="math inline">\(P_a(1) = 1, P_a(-1) = (-1)^a\)</span>. Use upwind:</p>
<p><span class="math display">\[
\hat{\psi}_a(x; \hat{\psi}_a^{-}, \hat{\psi}_a^{+}) = \begin{cases} \hat{\psi}_a^{-} &amp; u &lt; 0 \\ \hat{\psi}_a^{+} &amp; u &gt; 0 \end{cases}
\]</span></p>
<aside class="notes">
<p>We now pick the basis functions for our convenience. If we can make the mass matrix diagonal then we are following the steps in the spectral method case, where we saw exponential convergence. We do this by choosing the basis functions to be orthogonal polynomials.</p>
<p>In one dimension we can, as in the Galerkin case, map to the reference element. On this reference element the Legendre polynomials have nice convergence properties. Typically when using library functions to provide the Legendre polynomials we need to rescale in order to make them orthonormal rather than orthogonal.</p>
<p>At this point the algorithm would appear very similar to the standard Galerkin case. We have a discrete algorithm using mass and stiffness matrices. One difference is that we have one set of matrices <em>per element</em> which we solve separately for each. They are never combined into a global matrix. A second difference is that the modal coefficients we are solving for do not correspond to the nodal values of the function. Instead they are closer to the spectral case, giving a series approximation separately within each element.</p>
<p>This algorithm would work (given more detailed implementation). It would show spectral, or exponential, convergence if the number of elements were held fixed whilst the number of basis functions per element were increased. It would show polynomial convergence if the number of basis functions were held fixed whilst the number of elements increased. The order of polynomial convergence is linked to the number of basis functions used.</p>
<p>However, this algorithm has one crucial problem. The communication pattern of the algorithm is determined by how many numbers need transferring between elements. This is done through the boundary flux. This <em>modal</em> DG algorithm transfers one number per mode per variable. As the number of modes increases, that becomes prohibitive.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nodal-dg" class="slide level2 smaller">
<h2>Nodal DG</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Count: <span class="math inline">\(\sum_{n=1}^{N_\text{modes}} \hat{\psi}_n N_n \leftrightarrow \{ \psi( \xi_n ) \equiv \psi_n \}\)</span>.</p>
<p>If <em>nodes</em> <span class="math inline">\(\{ \xi_n \}\)</span> chosen well, solve <span class="math inline">\(\psi_n\)</span> directly.</p>
<div class="fragment">
<p>Gauss-Lobatto points:</p>
<ul>
<li>nodes <span class="math inline">\(\xi = \{ \pm 1 \}\)</span>: communicate one number;</li>
<li>natural for Gauss quadrature.</li>
</ul>
<p><em>Vandermonde</em> matrix <span class="math inline">\(\hat{V}_{in} = P_n(\xi_n)\)</span>:</p>
<p><span class="math display">\[
\hat{V}_{in} \hat{\psi}_n = \psi_i \, .
\]</span></p>
</div>
</div><div class="column" style="width:40%;">
<div id="7a7cc9d2" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lecture_fe_dg_files/figure-revealjs/cell-5-output-1.svg"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>If communication is the problem, then using the value of the solution itself at the boundary have to be part of the answer. As the solution at the boundary of the element gives a single number for the boundary flux, if that were known directly we would only have to communicate one number.</p>
<p>We can immediately note that, by a counting argument, we should be able to choose nodes <em>inside the element</em> so that the information contained within the solution values at the nodes is precisely the information in the modal coefficients. This is not saying that the values are the same. It is instead saying that there should be a map from one set of information to the other.</p>
<p>The standard choice is to use Gauss-Lobatto points for the nodes. These are like the nodes used in Gauss-Legendre quadrature, except that they force there to be points on the boundaries of the element. It’s essential that we have the boundary points to solve the communication problem. It’s useful to use these points as quadrature formulas are well known, making it easy to compute the integrals needed for the mass and stiffness matrices.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nodal-dg-equations" class="slide level2">
<h2>Nodal DG equations</h2>
<p>Nodal values <span class="math inline">\(\psi_i\)</span> also give</p>
<p><span class="math display">\[
M_{ab} \partial_t \psi_a + K_{ab} \psi_a = F_b \, .
\]</span></p>
<p>Use Vandermonde matrix to map to nodes:</p>
<p><span class="math display">\[
\begin{aligned}
M &amp;= \left( \hat{V} \hat{V}^T \right)^{-1} \, , \\
K^T &amp;= M \left( \partial_x \hat{V} \right) \hat{V}^{-1} \, .
\end{aligned}
\]</span></p>
<p>Force vector is flux on boundary nodes only. Map to reference scales <span class="math inline">\(M\)</span> by <span class="math inline">\(\det(J)\)</span>, not <span class="math inline">\(K\)</span>.</p>
<aside class="notes">
<p>When working with the nodes rather than the modes we still get the exact form of the equations, with mass and stiffness matrices. We can use the Vandermonde matrix to compute the nodal matrices from the modal case, where they are simpler.</p>
<p>In particular, the modal mass matrix was the identity. To map to the nodal case we need to map to modes and back, hence getting the displayed combination of the Vandermonde matrix. For the stiffness matrix here where only a single derivative is included we get a single derivative of the Vandermonde matrix, and a combination of mappings that is most easily expressed using the mass matrix.</p>
<p>For implementation purposes we have to note that we’ve computed everything on the reference element. To work with multiple elements we need to scale some terms by the determinant of the coordinate transform, which (in this case) applies to the mass matrix but not the stiffness matrix.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="implementation" class="slide level2 smaller">
<h2>Implementation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="sourceCode" id="cb1" data-code-line-numbers="1-18|20-32|34-37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">from</span> numpy.polynomial <span class="im">import</span> legendre</span>
<span id="cb1-2"><a href=""></a><span class="im">from</span> scipy.integrate <span class="im">import</span> ode</span>
<span id="cb1-3"><a href=""></a><span class="im">import</span> quadpy</span>
<span id="cb1-4"><a href=""></a>m <span class="op">=</span> <span class="dv">4</span> <span class="co"># modes</span></span>
<span id="cb1-5"><a href=""></a>Ne <span class="op">=</span> <span class="dv">10</span> <span class="co"># Number of elements</span></span>
<span id="cb1-6"><a href=""></a>GL <span class="op">=</span> quadpy.c1.gauss_lobatto(m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href=""></a>nodes <span class="op">=</span> GL.points</span>
<span id="cb1-8"><a href=""></a>weights <span class="op">=</span> GL.weights</span>
<span id="cb1-9"><a href=""></a>V_hat <span class="op">=</span> legendre.legvander(nodes, m)</span>
<span id="cb1-10"><a href=""></a>c <span class="op">=</span> np.eye(m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-11"><a href=""></a><span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(m<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-12"><a href=""></a>    V_hat[:, p] <span class="op">/=</span> np.sqrt(<span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb1-13"><a href=""></a>    c[p, p] <span class="op">/=</span> np.sqrt(<span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb1-14"><a href=""></a>V_hat_inv <span class="op">=</span> np.linalg.inv(V_hat)</span>
<span id="cb1-15"><a href=""></a>d_V_hat <span class="op">=</span> legendre.legval(nodes, legendre.legder(c)).T</span>
<span id="cb1-16"><a href=""></a>M <span class="op">=</span> np.linalg.inv(V_hat <span class="op">@</span> V_hat.T)</span>
<span id="cb1-17"><a href=""></a>M_inv <span class="op">=</span> V_hat <span class="op">@</span> V_hat.T</span>
<span id="cb1-18"><a href=""></a>K <span class="op">=</span> (M <span class="op">@</span> (d_V_hat <span class="op">@</span> np.linalg.inv(V_hat))).T</span>
<span id="cb1-19"><a href=""></a></span>
<span id="cb1-20"><a href=""></a><span class="kw">def</span> dpsidt(t, psi):</span>
<span id="cb1-21"><a href=""></a>    rhs <span class="op">=</span> np.zeros_like(psi)</span>
<span id="cb1-22"><a href=""></a>    dpdt <span class="op">=</span> np.zeros_like(psi)</span>
<span id="cb1-23"><a href=""></a>    <span class="cf">for</span> e <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, Ne<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-24"><a href=""></a>        lo <span class="op">=</span> e<span class="op">*</span>(m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-25"><a href=""></a>        hi <span class="op">=</span> (e<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-26"><a href=""></a>        rhs[lo:hi] <span class="op">+=</span> u <span class="op">*</span> Ks <span class="op">@</span> psi[lo:hi]</span>
<span id="cb1-27"><a href=""></a>        rhs[lo] <span class="op">+=</span> u <span class="op">*</span> psi[lo<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb1-28"><a href=""></a>        rhs[hi<span class="op">-</span><span class="dv">1</span>] <span class="op">-=</span> u <span class="op">*</span> psi[hi<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb1-29"><a href=""></a>        dpdt[lo:hi] <span class="op">=</span> (M_inv <span class="op">/</span> dx_e <span class="op">*</span> <span class="dv">2</span>) <span class="op">@</span> rhs[lo:hi]</span>
<span id="cb1-30"><a href=""></a>    dpdt[:m<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> dpdt[<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(m<span class="op">+</span><span class="dv">1</span>):<span class="op">-</span>(m<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb1-31"><a href=""></a>    dpdt[<span class="op">-</span>(m<span class="op">+</span><span class="dv">1</span>):] <span class="op">=</span> dpdt[(m<span class="op">+</span><span class="dv">1</span>):<span class="dv">2</span><span class="op">*</span>(m<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb1-32"><a href=""></a>    <span class="cf">return</span> dpdt</span>
<span id="cb1-33"><a href=""></a></span>
<span id="cb1-34"><a href=""></a>cfl <span class="op">=</span> <span class="fl">0.5</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-35"><a href=""></a>r <span class="op">=</span> ode(dpsidt).set_integrator(<span class="st">'dopri5'</span>, max_step<span class="op">=</span>cfl<span class="op">*</span>dx_e)</span>
<span id="cb1-36"><a href=""></a>r.set_initial_value(psi0)</span>
<span id="cb1-37"><a href=""></a>r.integrate(t_end)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:40%;">
<div id="64b001bc" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="lecture_fe_dg_files/figure-revealjs/cell-6-output-1.svg"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Having put in all that work, here is a sketch implementation.</p>
<p>The largest chunk of code is preliminary setup. We get the Gauss-Lobatto node locations within the reference element from <code>quadpy</code>. We then get the Vandermonde matrix for moving between modal and nodal coefficients from <code>numpy</code>. However, the Legendre definitions are not normalised, so we need to re-normalize them to make the basis functions orthonormal. From this we can define the derivatives of the Vandermonde matrix and hence the mass and stiffness matrices.</p>
<p>The next chunk of code defines the time derivative. Inside each element we set the update initially just using the stiffness matrix. We then correct the update using the boundary fluxes. This is using upwind corrections at the right and left edge of the element. Finally, we multiply by the inverse mass matrix. This is scaled to take into account that the element in real space is a different size to the reference element. Usually, using the explicit inverse is a bad idea. In this case, because the mass matrix is defined using an inversion, it is easy to accurately define the inverse. Boundary conditions are imposed using ghost elements.</p>
<p>The final step uses the method of lines to evolve the solution in time.</p>
<p>The results are first shown after five periods, using only ten elements and five modes (including the zero mode). There is next to no amplitude error, but the phase error is visible.</p>
<p>By increasing the number of modes whilst keeping the number of elements fixed we see exponential convergence. This is another main selling point of DG methods.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>Discontinuous Galerkin methods work on unstructured grids and give spectral convergence.</li>
<li>DG methods are efficient on exascale machines.</li>
<li>Setting up a DG scheme is more work.</li>
<li>Making DG methods work with discontinuous data is hard.</li>
</ul>
<aside class="notes">
<p>DG methods combine the accuracy advantages of spectral methods with the flexibility of finite element methods - at least in principle. They are hard work to set up, as seen from the code. In addition, the size of the matrices, even within a single element, grows rapidly with the number of dimensions. However, there are practical DG implementations in engineering use with some very complex systems.</p>
<p>The other additional problem is that DG methods suffer with similar problems to spectral methods with discontinuous data. There is considerable effort to make them work in this case, some of it successful, but much relies on coupling to finite volume codes. It is not yet clear whether finite volume or DG approaches will be best on the next generation of computers.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="https://ianhawke.github.io/mfc_cdt_numerics" class="uri">https://ianhawke.github.io/mfc_cdt_numerics</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture_fe_dg_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture_fe_dg_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lecture_fe_dg_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>